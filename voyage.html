<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰å¤§èˆªç·šæŠ•è³‡æ±ºç­–</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;900&family=Varela+Round&display=swap" rel="stylesheet">
    <style>
        :root {
            --highlight-pink: #FF9D6F;
            --morandi-bg: #FBFBF9;
            --tag-bg: #F0EFEB;
            --accent-purple: #5E548E;
        }
        body { 
            font-family: 'Varela Round', 'Noto Sans TC', "Microsoft JhengHei", sans-serif;
            background-color: #EAE8E4; 
            color: #6D6875;
        }
        [v-cloak] { display: none; }
        
        /* çµ±ä¸€åœ“è§’èˆ‡é™°å½± */
        .card-standard { 
            background-color: var(--morandi-bg); 
            border: 1px solid #D7D3CC;
            border-radius: 2rem;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.02);
        }

        /* è¼¸å…¥æ¡†æ¨£å¼å„ªåŒ– */
        input {
            background-color: #F4F2EE !important;
            border: 1px solid #D7D3CC !important;
            border-radius: 0.75rem !important;
            padding: 0.5rem !important;
            text-align: right;
            font-weight: 900;
            color: var(--accent-purple);
        }
        input:focus { outline: 2px solid var(--highlight-pink); border-color: transparent !important; }

        /* æ¨™ç±¤æ¨£å¼ */
        .section-tag {
            background-color: var(--tag-bg);
            color: var(--accent-purple);
            padding: 4px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 900;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .highlight-box {
            background: linear-gradient(135deg, #FDF2F0 0%, #FBFBF9 100%);
            border: 2px solid var(--highlight-pink);
        }
        
        /* éš±è—æ•¸å€¼èª¿ç¯€å™¨ */
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div id="app" v-cloak class="max-w-7xl mx-auto">
        
        <div class="flex flex-col lg:flex-row justify-between items-center mb-8 bg-[#FBFBF9] p-8 rounded-[2rem] shadow-sm border border-[#D7D3CC] gap-6">
            <div class="flex items-center gap-5">
                <div class="w-16 h-16 bg-[#5E548E] rounded-2xl flex items-center justify-center text-[#F4F2EE] text-3xl font-black">ğŸš¢</div>
                <div>
                    <h2 class="text-3xl font-black text-[#5E548E] tracking-tight">å‰å¤§èˆªç·šæŠ•è³‡æ±ºç­–</h2>
                    <p class="text-xs font-bold text-[#8E9AAF] tracking-widest">GRAND LINE INVESTMENT</p>
                </div>
            </div>
            <div class="flex gap-3">
                <button @click="resetData" class="bg-[#AF7A7D] text-white px-6 py-4 rounded-2xl text-base font-black shadow-sm">ğŸ—‘ï¸ é‡ç½®è³‡æ–™</button>
                <button onclick="location.href='portal.html'" class="bg-[#6D6875] text-white px-6 py-4 rounded-2xl text-base font-black shadow-sm">è¿”å›å…¥å£</button>
            </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-12 gap-6">
            
            <div class="xl:col-span-8 space-y-6">
                <div class="card-standard">
                    <span class="section-tag">è¡¨â‚€ åŸºç¤è³‡æ–™è¼¸å…¥</span>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="flex flex-col gap-1">
                            <label class="text-xs font-black text-[#8E9AAF] ml-2">å¯ç”¨è³‡é‡‘</label>
                            <input type="number" v-model.number="fund" placeholder="è³‡é‡‘">
                        </div>
                        <div class="flex flex-col gap-1">
                            <label class="text-xs font-black text-[#8E9AAF] ml-2">å‰©é¤˜è¼‰é‡</label>
                            <input type="number" v-model.number="capacity" placeholder="è¼‰é‡">
                        </div>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead>
                                <tr class="text-[#8E9AAF] text-xs font-black uppercase">
                                    <th class="p-2">å“é …</th>
                                    <th class="p-2 text-right">äº¤æ˜“å·®åƒ¹</th>
                                    <th class="p-2 text-right">æ¼²è·Œ%</th>
                                    <th class="p-2 text-right">è³¼è²·é‡</th>
                                    <th class="p-2 text-right">å–®ä½æ¯›åˆ©</th>
                                    <th class="p-2 text-right">é ä¼°æ·¨åˆ©</th>
                                </tr>
                            </thead>
                            <tbody class="font-bold">
                                <tr v-for="item in products" :key="item.name" class="border-t border-[#F0EFEB]">
                                    <td class="p-3 text-[#5E548E] font-black">{{ item.name }}</td>
                                    <td class="p-2"><input type="number" v-model.number="item.priceDiff" class="w-full"></td>
                                    <td class="p-2"><input type="number" v-model.number="item.trend" class="w-full"></td>
                                    <td class="p-2"><input type="number" v-model.number="item.quantity" class="w-full"></td>
                                    <td class="p-2 text-right text-sm">{{ formatMoney(getUnitProfit(item)) }}</td>
                                    <td class="p-2 text-right text-sm text-[#FF9D6F]">{{ formatMoney(getTotalProfit(item)) }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="card-standard" :class="{'opacity-50': fund > totalCost0}">
                        <span class="section-tag">è¡¨â‚ ç‰¹ç”¢å„ªå…ˆè¨ˆç®— (è³‡é‡‘ä¸è¶³æ™‚)</span>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center bg-white p-3 rounded-xl border border-[#D7D3CC]">
                                <span class="text-xs font-black text-[#8E9AAF]">è²·ç©ºç‰¹ç”¢å‰©é¤˜è³‡é‡‘</span>
                                <span class="font-black text-[#5E548E]">{{ formatMoney(remainFund1) }}</span>
                            </div>
                            <div class="grid grid-cols-2 gap-2">
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] font-black ml-1">å‰¯ç”¢å”®åƒ¹</label>
                                    <input type="number" v-model.number="extraPrice1">
                                </div>
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] font-black ml-1">å‰¯ç”¢æ¼²è·Œ%</label>
                                    <input type="number" v-model.number="extraTrend1">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card-standard" :class="{'opacity-50': fund > totalCost0}">
                        <span class="section-tag">è¡¨â‚‚ é«˜æ¯›åˆ©å‰¯ç”¢è¨ˆç®—</span>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center bg-white p-3 rounded-xl border border-[#D7D3CC]">
                                <span class="text-xs font-black text-[#8E9AAF]">è²·ç©ºé«˜æ¯›åˆ©å‰©é¤˜è³‡é‡‘</span>
                                <span class="font-black text-[#5E548E]">{{ formatMoney(remainFund2) }}</span>
                            </div>
                            <div class="grid grid-cols-2 gap-2">
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] font-black ml-1">å…¶ä»–å”®åƒ¹</label>
                                    <input type="number" v-model.number="extraPrice2">
                                </div>
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] font-black ml-1">å…¶ä»–æ¼²è·Œ%</label>
                                    <input type="number" v-model.number="extraTrend2">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="xl:col-span-4 space-y-6">
                <div class="card-standard highlight-box">
                    <span class="section-tag" style="background-color: #FF9D6F; color: white;">ğŸ† æœ€ä½³æŠ•è³‡æ–¹æ¡ˆåˆ¤æ–·</span>
                    <div class="mt-4 p-6 bg-white rounded-[1.5rem] shadow-inner border border-[#FF9D6F]/20">
                        <p class="text-[10px] font-black text-[#8E9AAF] mb-1 uppercase tracking-widest">ç³»çµ±å»ºè­°</p>
                        <p class="text-2xl font-black text-[#FF9D6F] leading-tight mb-4">{{ finalDecision.msg }}</p>
                        <hr class="mb-4">
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-sm font-bold">åˆ¤æ–·ä¾æ“š:</span>
                                <span class="text-sm font-black text-[#5E548E]">{{ finalDecision.reason }}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm font-bold">é ä¼°ç¸½æ·¨åˆ©:</span>
                                <span class="text-xl font-black text-[#FF9D6F]">{{ formatMoney(finalDecision.profit) }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 space-y-3">
                        <div class="flex justify-between text-xs font-bold border-b border-[#D7D3CC] pb-2">
                            <span>è¡¨â‚€ æœ€é«˜æ·¨åˆ©æ–¹æ¡ˆ</span>
                            <span>{{ formatMoney(bestByNet0.profit) }}</span>
                        </div>
                        <div v-if="fund <= totalCost0" class="flex justify-between text-xs font-bold border-b border-[#D7D3CC] pb-2">
                            <span>è¡¨â‚ ç¸½æ·¨åˆ©(è²·ç©ºç‰¹ç”¢+)</span>
                            <span>{{ formatMoney(totalNetProfit1) }}</span>
                        </div>
                        <div v-if="fund <= totalCost0" class="flex justify-between text-xs font-bold border-b border-[#D7D3CC] pb-2">
                            <span>è¡¨â‚‚ ç¸½æ·¨åˆ©(è²·ç©ºé«˜æ¯›åˆ©å‰¯ç”¢+)</span>
                            <span>{{ formatMoney(totalNetProfit2) }}</span>
                        </div>
                    </div>
                </div>

                <div class="card-standard bg-[#6D6875] text-white">
                    <h4 class="font-black mb-4 flex items-center gap-2">
                        <span>ğŸ’¡</span> æ“ä½œæç¤º
                    </h4>
                    <ul class="text-xs space-y-3 font-bold opacity-90">
                        <li>â— è¼‰é‡èˆ‡è³‡é‡‘è¶³å¤ æ™‚ï¼Œåƒè€ƒã€Œè¡¨â‚€ã€çµæœå³å¯ã€‚</li>
                        <li>â— è³‡é‡‘ä¸è¶³æ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•æ¯”å°ã€Œè¡¨â‚ã€èˆ‡ã€Œè¡¨â‚‚ã€ã€‚</li>
                        <li>â— è‹¥ç„¡ç‰¹ç”¢ï¼Œè«‹å°‡ç‰¹ç”¢è³¼è²·é‡è¼¸å…¥ç‚º 0ã€‚</li>
                    </ul>
                </div>
            </div>

        </div>
    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    fund: 0,
                    capacity: 0,
                    products: [
                        { name: 'ç‰¹ç”¢', priceDiff: 0, trend: 0, quantity: 0, buyPrice: 1600 },
                        { name: 'å‰¯ç”¢ 1', priceDiff: 0, trend: 0, quantity: 0, buyPrice: 1200 },
                        { name: 'å‰¯ç”¢ 2', priceDiff: 0, trend: 0, quantity: 0, buyPrice: 1200 }
                    ],
                    extraPrice1: 0, extraTrend1: 0,
                    extraPrice2: 0, extraTrend2: 0
                }
            },
            computed: {
                // åŸæœ‰çš„è¤‡é›œé‚è¼¯ä¿æŒä¸è®Š
                bestByNet0() {
                    let best = { name: 'ç„¡', profit: 0 };
                    this.products.forEach(p => {
                        let profit = this.getTotalProfit(p);
                        if (profit > best.profit) { best = { name: p.name, profit: profit }; }
                    });
                    return best;
                },
                totalCost0() { return this.products.reduce((sum, p) => sum + (p.buyPrice * p.quantity), 0); },
                
                // è¡¨1 é‚è¼¯
                remainFund1() { 
                    const specialty = this.products.find(p => p.name === 'ç‰¹ç”¢');
                    return Math.max(0, this.fund - (specialty.buyPrice * specialty.quantity));
                },
                totalNetProfit1() {
                    const specialty = this.products.find(p => p.name === 'ç‰¹ç”¢');
                    const specProfit = this.getTotalProfit(specialty);
                    const extraQty = Math.floor(this.remainFund1 / 1200);
                    const extraProfit = extraQty * (this.extraPrice1 * (1 + this.extraTrend1/100) - 1200);
                    return specProfit + extraProfit;
                },

                // è¡¨2 é‚è¼¯
                remainFund2() {
                    const p1 = this.products.find(p => p.name === 'å‰¯ç”¢ 1');
                    const p2 = this.products.find(p => p.name === 'å‰¯ç”¢ 2');
                    const highGross = this.getUnitProfit(p1) > this.getUnitProfit(p2) ? p1 : p2;
                    return Math.max(0, this.fund - (highGross.buyPrice * highGross.quantity));
                },
                totalNetProfit2() {
                    const p1 = this.products.find(p => p.name === 'å‰¯ç”¢ 1');
                    const p2 = this.products.find(p => p.name === 'å‰¯ç”¢ 2');
                    const highGross = this.getUnitProfit(p1) > this.getUnitProfit(p2) ? p1 : p2;
                    const highProfit = this.getTotalProfit(highGross);
                    const extraQty = Math.floor(this.remainFund2 / 1200);
                    const extraProfit = extraQty * (this.extraPrice2 * (1 + this.extraTrend2/100) - 1200);
                    return highProfit + extraProfit;
                },

                finalDecision() {
                    if (this.fund > this.totalCost0 || this.fund <= 0) {
                        return { msg: "åƒè€ƒè¡¨â‚€ï¼š" + this.bestByNet0.name, profit: this.bestByNet0.profit, reason: "è³‡é‡‘/è¼‰é‡å……è¶³" };
                    }
                    if (this.totalNetProfit1 >= this.totalNetProfit2 && this.totalNetProfit1 >= this.bestByNet0.profit) {
                        return { msg: "æ–¹æ¡ˆä¸€ï¼šç‰¹ç”¢è²·ç©ºæ–¹æ¡ˆ", profit: this.totalNetProfit1, reason: "ç‰¹ç”¢åŸºç¤åˆ©æ½¤å„ªå‹¢" };
                    } else if (this.totalNetProfit2 >= this.totalNetProfit1 && this.totalNetProfit2 >= this.bestByNet0.profit) {
                        return { msg: "æ–¹æ¡ˆäºŒï¼šé«˜æ¯›åˆ©å‰¯ç”¢è²·ç©º", profit: this.totalNetProfit2, reason: "å‰¯ç”¢çµ„åˆæ”¶ç›Šè¼ƒé«˜" };
                    }
                    return { msg: "æ–¹æ¡ˆä¸‰ï¼šå–®è²·æœ€å„ªå‰¯ç”¢", profit: this.bestByNet0.profit, reason: "è³‡é‡‘ä¸é©å®œæ‹†åˆ†è³¼è²·" };
                }
            },
            methods: {
                getUnitProfit(p) { return p.priceDiff * (1 + p.trend/100); },
                getTotalProfit(p) { return this.getUnitProfit(p) * p.quantity; },
                formatMoney(val) {
                    if (!val) return '0';
                    return val.toLocaleString(undefined, { maximumFractionDigits: 0 }) + ' è²é‡Œ';
                },
                resetData() {
                    this.fund = 0; this.capacity = 0;
                    this.products.forEach(p => { p.priceDiff = 0; p.trend = 0; p.quantity = 0; });
                    this.extraPrice1 = 0; this.extraTrend1 = 0;
                    this.extraPrice2 = 0; this.extraTrend2 = 0;
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
